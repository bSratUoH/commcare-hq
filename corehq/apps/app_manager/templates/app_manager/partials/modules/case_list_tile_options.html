{% load app_manager_extras %}
{% load hq_shared_tags %}
{% load i18n %}
{% load xforms_extras %}

{% if request|toggle_enabled:'CASE_LIST_TILE' %}
  <div class="row">
    <div class="col-sm-6">
      <select data-bind="value: useCaseTiles" class="form-control">
        <option value="no">{% trans "Don't Use Case Tiles" %}</option>
        <option value="yes">{% trans "Use Case Tiles" %}</option>
      </select>
    </div>
  </div>
{% endif %}
{% if request|toggle_enabled:'SHOW_PERSIST_CASE_CONTEXT_SETTING' %}
  <div data-bind="visible: useCaseTiles() == 'no'">
    <div class="checkbox">
      <label>
        <input type="checkbox" data-bind="checked: persistCaseContext">
        {% trans "Show some information about the case at the top of the screen when filling out forms" %}
      </label>
    </div>
    <div class="form-inline" data-bind="visible: persistCaseContext">
      <label>
        {% trans "Case property to show" %}
      </label>
      <input class="form-control" type="text" data-bind="value: persistentCaseContextXML" placeholder="e.g. case_name" />
    </div>
  </div>
{% endif %}
<div data-bind="visible: useCaseTiles() == 'yes' || hqImport('hqwebapp/js/toggles').toggleEnabled('CASE_LIST_CUSTOM_XML')">
  <div class="checkbox">
    <label>
      <input type="checkbox" data-bind="checked: persistTileOnForms">
      {% trans "Use this case list tile persistently in forms" %}
    </label>
  </div>
</div>

{% if request|toggle_enabled:'CASE_LIST_TILE' %}
  {% with app|get_available_modules_for_case_tile_configuration:module as available_modules %}
    {% if available_modules %}
      <div class="row">
        <div class="col-sm-6">
          <label>
            {% trans "Use persistent case tile from menu" %}
          </label>
          <div>
            <select name='persistent_case_tile_from_module' class='form-control' data-bind="value: persistentCaseTileFromModule">
              <option value>
                {% trans "Select Menu" %}
              </option>
              {% for other_mod in available_modules %}
                <option value={{ other_mod.unique_id }}>{{ other_mod.name|html_trans:langs }}</option>
              {% endfor %}
            </select>
          </div>
        </div>
      </div>
    {% endif %}
  {% endwith %}
{% endif %}

<div data-bind="visible: useCaseTiles() == 'yes' || persistentCaseTileFromModule() || hqImport('hqwebapp/js/toggles').toggleEnabled('CASE_LIST_CUSTOM_XML')">
  <div class="checkbox" data-bind="visible: persistTileOnForms() || persistentCaseTileFromModule">
    <label>
      <input type="checkbox" data-bind="checked: enableTilePullDown">
      <span data-bind="visible: persistTileOnForms() && !persistentCaseTileFromModule()">
                  {% trans "Embed case details in case tile pull-down" %}
              </span>
      <span data-bind="visible: persistentCaseTileFromModule()">
                  {% trans "Embed case details in case tile pull-down from the menu" %}
              </span>
    </label>
  </div>
</div>
